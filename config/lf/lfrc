# vim: filetype=conf

set shell sh
set shellopts '-eu'
set ifs "\n"
set scrolloff 10
set icons
set ratios 1:2:3
set period 1
set cleaner '~/.config/lf/cleaner.sh'
set previewer '~/.config/lf/scope.sh'

# COMMANDS
cmd open ${{
	case $(file --mime-type "$f" -b) in
		text/*)
			$EDITOR "$f";;
		*)
			[ -x "$f" ] \
				&& lf -remote "send $id !$f" \
				|| setsid $OPENER "$f" >/dev/null 2>&1 ;;
	esac
}}

cmd bulk-rename $vidir

cmd delete ${{
	set -f
	printf "%s\n" "$fx"
	printf "Delete? [y/n] "
	read ans
	[ $ans = "y" ] && rm -rf -- $fx
}}

cmd mkdir %mkdir "$@"
cmd mkfile %touch "$@"

map <c-f> $lf -remote "send $id select '$(fzf)'"
map J $lf -remote "send $id cd $(awk '/^[^#]/ {print $2}' ${XDG_CONFIG_HOME}/shortcuts/directories | fzf)"
map <enter> shell
map s $$SHELL
map U clear
map <backspace2> set hidden!
map V :unselect; invert
map D delete
map mkd push :mkdir<space>
map mkf push :mkfile<space>
map o &mimeopen $f
map O $mimeopen --ask $f
map x &sxiv -at .
map P &mpv .

map a rename # at the very end
map r push a<c-u> # new rename
map R push a<a-b><a-b><a-f><c-u> # keep ext
map i push a<c-a> # at the very beginning
map B bulk-rename

map ww $watched $f

source ~/.config/lf/lfshortcuts
