#!/usr/bin/env sh

engines=$(
    cat <<- EOF
1 ðŸ‡¯ðŸ‡µ anthy æ–‡
2 ðŸ‡¬ðŸ‡· fcitx-keyboard-gr AÎ©
EOF
)

DUNST_ID=9191

notify() { dunstify -r $DUNST_ID "ib" "$@"; }

case "$1" in
    toggle)
        case "$(fcitx-remote)" in
            1) fcitx-remote -t ;;
            2) fcitx-remote -T ;;
            *) ;;
        esac
        ;;

    select)
        echo "$engines" \
            | cut -d ' ' -f1-2 \
            | dmenu -p 'Keyboard layout' -L "$(echo "$engines" | wc -l)" -width 10 \
            | {
                read -r choice
                choice=$(echo "$engines" | grep "${choice:?}")
                engine=$(echo "$choice" | cut -d ' ' -f3)
                fcitx-remote -s "$engine"
            }
        ;;

    *)
        exit
        ;;

esac 2> /dev/null
