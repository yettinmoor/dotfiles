#!/usr/bin/env sh

while getopts n o; do
    case $o in
        n) devour() { "$@"; } ;;
        *) echo 'devour [-n] ...' ;;
    esac
done

shift $((OPTIND - 1))

[ $# -eq 0 ] && {
    echo 'launch [args]'
    exit 1
}

command -v devour > /dev/null 2>&1 || devour() { "$@"; }

case "$(file --mime-type "$@" -bL)" in
    video/* | audio/*)
        devour mpv "$@"
        ;;
    application/pdf | \
        application/postscript | \
        application/epub+zip | \
        application/x-rar | \
        image/vnd.djvu)
        devour zathura "$@"
        ;;
    image/*)
        devour sxiv "$@"
        ;;
    application/x-bittorrent)
        devour tor "$@"
        ;;
    text/html)
        devour "$BROWSER" "$@"
        ;;
    *)
        "$EDITOR" "$@"
        ;;
esac
