#!/usr/bin/env sh
# Display fzf menu of
#   all git-tracked dotfiles,
#   all scripts in .local/bin,
#   all items in .config/shell,
# and open selected item in editor.

dir=$(mktemp -d)
fifo="$dir/se.fifo"
mkfifo "$fifo"

git -C ~/repos/dotfiles ls-tree -r --name-only HEAD >> "$fifo" &
fd . --base-directory ~/repos/dotfiles local/bin >> "$fifo" &
fd . --base-directory ~/repos/dotfiles config/shell >> "$fifo" &

sort "$fifo" \
    | uniq \
    | fzf --reverse --color=16 \
    | xargs -r -I {} "$EDITOR" "$HOME/repos/dotfiles/{}"

rm -r "$dir"
