#!/usr/bin/env sh

file="${XDG_DATA_HOME:-$HOME/.local/share}/weatherreport"

fetch() {
    ping -q -c 1 1.1.1.1 >/dev/null || exit 1
    report=$(curl -s "wttr.in/$1")
    echo "$report" | grep "Sorry" && exit 1 # Exit if wttr server overload
    echo "$report" > "$file";
}

display() {
    sed -nE '4s/.*([+-][0-9]+).*/\1Â°/p' "$file" | tr -d '+';
}

[ -n "$1" ] && $1 "$2"
